async function analyze(t=null){const e=t||document.getElementById("authorIdInput").value.trim();if(!e)return void showStatus("Please enter an OpenAlex Author ID.","danger");const n=document.getElementById("loadingSpinner"),o=document.getElementById("statusAlert"),s=document.getElementById("resultsContainer"),a=document.querySelector("#resultTable tbody");n.style.display="block",o.style.display="none",s.style.display="none",a.innerHTML="";try{const t=`https://api.openalex.org/authors/${e}`,n=await fetch(t);if(!n.ok)throw new Error("Author not found. Please check the ID.");const o=(await n.json()).display_name;document.getElementById("resultsTitle").textContent=`Co-authors of ${o}`;const r={};let l="*";for(;l;){const t=`https://api.openalex.org/works?filter=author.id:${e}&per-page=200&cursor=${l}`,n=await fetch(t),s=await n.json();s.results&&s.results.forEach(t=>{t.authorships.forEach(t=>{const e=t.author.id?t.author.id.split("/").pop():null,n=t.author.display_name;e&&n&&n!==o&&(r[n]||(r[n]={ids:new Set,count:0}),r[n].ids.add(e),r[n].count+=1)})}),l=s.meta.next_cursor}if(0===Object.keys(r).length)return void showStatus("No co-author data found for this author ID.","danger");Object.entries(r).sort((t,e)=>e[1].count-t[1].count).forEach(([t,e])=>{const n=Array.from(e.ids),o=`<tr>\n        <td class="hidden-id">${n.join(", ")}</td>\n        <td title="OpenAlex IDs: ${n.join(", ")}">${t}</td>\n        <td style="text-align: center;">${e.count}</td>\n      </tr>`;a.insertAdjacentHTML("beforeend",o)}),s.style.display="block"}catch(t){showStatus(`Error: ${t.message}`,"danger")}finally{n.style.display="none"}}function showStatus(t,e="info"){const n=document.getElementById("statusAlert");n.textContent=t,n.className=`alert-custom alert-${e}-custom`,n.style.display="block"}